<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Módulo de Asesores - Be Gestion</title>
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
    <div class="container">
        <a href="/index.html" class="back-button">&larr; Volver al Menú Principal</a>

        <h1 class="main-title">Módulo de Asesores</h1>
        <nav class="nav-grid">
            <a href="/registrar_visita.html" class="nav-button">Registrar Visita</a>
            <a href="/reporte_visitas.html" class="nav-button" id="btn-reporte-visitas">Reporte de Visitas</a>
            <a href="/solicitud_cotizacion.html" class="nav-button">Solicitud de Cotización</a>
            <a href="/aprobacion.html" class="nav-button">Revisión de Cotizaciones</a>
        </nav>
        
        <a href="#" id="logout-btn" class="back-link" style="margin-top: 20px;">Cerrar Sesión</a>
    </div>

    <script src="/main.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Hacemos una llamada a la nueva API para obtener los datos del usuario en sesión
                const response = await fetch('/api/user-session');
                if (response.ok) {
                    const user = await response.json();
                    const reporteVisitasBtn = document.getElementById('btn-reporte-visitas');
                    
                    // Si el rol del usuario es 'Asesor' (y solo Asesor), ocultamos el botón
                    if (user && user.rol === 'Asesor') {
                        if(reporteVisitasBtn) {
                           reporteVisitasBtn.style.display = 'none';
                        }
                    }
                }
            } catch (error) {
                console.error('No se pudo verificar el rol del usuario para el menú:', error);
            }
        });
    </script>
    </body>
</html>
